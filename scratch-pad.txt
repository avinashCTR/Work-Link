# airflow import
from airflow import DAG

# custom operators import
from CouturePythonDockerPlugin import CouturePythonDockerOperator
from CoutureSpark3Plugin import CoutureSpark3Operator as CoutureSparkOperator
from DagOperatorPlugin import DagOperator

classPath = "ai.couture.discovery.MainClass"
code_artifact = "couture-discovery-pipelines-1.0.0-avinash.jar"

default_args = {
    "owner": "couture",
    "depends_on_past": False,
    "config_group": "config_group_jiomart_large",
    "start_date": date,
    "retries": 0,
    "retry_delay": timedelta(minutes=1)
}

Dag = DAG("couture-discovery-test", default_args=default_args, concurrency=4, schedule_interval=None, tags=["couture-discovery"])

discovery-test = CoutureSparkOperator(
    task_id="discovery-test",
    dag=Dag,
    code_artifact=code_artifact,
    class_path=classPath,
    method_id="ExtractUserFeatures",
    method_args_dict={},
    input_base_dir_path="",
    output_base_dir_path="",
    input_filenames_dict={},
    output_filenames_dict={}
    description=""
)

